<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Battle of Britpop Quiz</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4ff;
      padding: 20px;
      text-align: center;
    }

    header {
      background: #1a237e;
      color: white;
      padding: 20px;
    }

    .container {
      background: white;
      padding: 30px;
      max-width: 600px;
      margin: auto;
      border-radius: 10px;
      box-shadow: 0 0 10px #ccc;
    }

    .option {
      display: block;
      margin: 10px auto;
      padding: 10px;
      width: 100%;
      background: #c5cae9;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }

    .option:hover {
      background: #9fa8da;
    }

    input, button {
      padding: 10px;
      margin-top: 10px;
      width: 100%;
    }

    #leaderboard {
      margin-top: 30px;
      text-align: left;
    }
  </style>
</head>
  <body>

<header>
    <h1>MEPz: Mother Earth Protection Zone</h1>
    <nav>
      <a href="index.html">About</a>
      <a href="pollution.html">Pollution</a>
      <a href="quiz.html">Quiz</a>
    </nav>
  </header>


<div class="container">

  <div id="quiz">
    <h2 id="question">Loading...</h2>
    <div id="options"></div>
  </div>

  <div id="score-screen" style="display:none;">
    <h2>Quiz Finished!</h2>
    <p>Your Score: <span id="final-score"></span></p>
    <input id="username" placeholder="Enter your name">
    <button id="submit-btn">Submit Score</button>
  </div>

  <div id="leaderboard">
    <h3>üèÜ Leaderboard</h3>
    <ol id="leaderboard-list"></ol>
  </div>

</div>

 <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, set, push, onValue, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDJdh_CHt2hfUyYfwZDtaCxd6uRJMVJjwQ",
  authDomain: "quiz-page-a48e9.firebaseapp.com",
  databaseURL: "https://quiz-page-a48e9-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "quiz-page-a48e9",
  storageBucket: "quiz-page-a48e9.firebasestorage.app",
  messagingSenderId: "692408786948",
  appId: "1:692408786948:web:bd419278e8d9afeb03d551",
  measurementId: "G-9CC6K29C1J"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const leaderboardRef = ref(db, 'leaderboard');

  // --- QUIZ LOGIC ---
  const questions = [
    {
        question: "What is the meaning of air pollution?",
        options: ["Air is polluted", "The alteration of air quality", "The air is dirty for breathing"],
        answer: "The alteration of air quality"
      },
      {
        question: "How many types of air pollution are there?",
        options: ["2", "8", "5"],
        answer: "2"
      },
      {
        question: "What are the man-made causes of air pollution? I. Power generation II. Forest fire III. Weather IV. Urbanization",
        options: ["I & II", "II & IV", "I & IV"],
        answer: "I & IV"
      },
      {
        question: "What does CFC stands for?",
        options: ["chloroflurocarbon", "chloroformcarbon", "carbonfluronatrium"],
        answer: "chloroflurocarbon"
      },
      {
        question: "Why does fossil fuel burning for power generation harmful for the air?",
        options: ["Releases harmful air pollutants", "create a serious haze", "Our atmoshphere become hotter"],
        answer: "Releases harmful air pollutants"
      },
      {
        question: "What are the effects of air pollution on our health?",
        options: ["heart attack", "Difficulty of breathing", "headache"],
        answer: "Difficulty of breathing"
      },
      {
        question: "What areas can have serious air pollution?",
        options: ["Rural areas", "Industrial areas", "Areas with a large population"],
        answer: "Industrial areas"
      },
      {
        question: "How does CFC affect our environment?",
        options: ["Damages building", "Kills plant and animal", "Destroys the ozone layer"],
        answer: "Destroys the ozone layer"
      },
      {
        question: "What does AQI stands for?",
        options: ["Aim Quality Index", "Air Quality Index", "I don't know"],
        answer: "Air Quality Index"
      },
      {
        question: "What does volcanic erruption release",
        options: ["Harmful air pollutant", "Black smoke", "Volcanic ash"],
        answer: "Volcanic ash"
      },
      {
        question: "What volcano errupted in 2010?",
        options: ["Mount Olympus", "Mount Pompeii", "Mount Eyjafjallaj√∂kull"],
        answer: "Mount Eyjafjallaj√∂kull"
      },
      {
        question: "What deserts were mentioned in the website?",
        options: ["Qatar Desert", "Egyptian Desert", "Gobi Desert"],
        answer: "Gobi Desert"
      },
      {
        question: "What does MEPz stands for?",
        options: ["Mother Earth Protection zone", "Mother Earth Privacy zone", "Must Early Protect zone"],
        answer: "Mother Earth Protection zone"
      },
      {
        question: "What electrical applieances contributed to CFC before it was banned?",
        options: ["Air Conditioner", "Vacuum", "Oven"],
        answer: "Air Conditioner"
      },
      {
        question: "Which of the following is a megacity",
        options: ["Kuala Lumpur", "Mumbai", "Tokyo"],
        answer: "Tokyo"
      },
      {
        question: "Which of the following is considered hazardous for PM 10 according to the AQI?",
        options: ["425+", "365+", "800+"],
        answer: "425+"
      },
      {
        question: "What can we do to reduce air pollution?",
        options: ["Ban the usage of diesel powered vehichle", "Limit the human population", "Plant trees in cities"],
        answer: "Plant trees in cities"
      },
      {
        question: "What agreement was signed to ban CFC in 1987?",
        options: ["The Montreal Protocol", "Treaty of Versailles", "The Potsdam Agreement"],
        answer: "The Montreal Protocol"
      },
       {
        question: "Which of the following country is considered the cleanest country according to the 2024 Environmental Performance Index?",
        options: ["America", "Japan", "Estonia"],
        answer: "Estonia"
      },
      {
        question: "Bonus Question: When was this website created?",
        options: ["2025", "Yesterday", "2013"],
        answer: "2025"
      },

  ];

  let current = 0;
  let score = 0;

  function showQuestion() {
    if (current >= questions.length) {
      showScore();
      return;
    }
    const q = questions[current];
    document.getElementById("question").textContent = q.question;
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";

    q.options.forEach(option => {
      const btn = document.createElement("button");
      btn.className = "option";
      btn.textContent = option;
      btn.onclick = () => {
        if (option === q.answer) score++;
        current++;
        showQuestion();
      };
      optionsDiv.appendChild(btn);
    });
  }

  function showScore() {
    document.getElementById("quiz").style.display = "none";
    document.getElementById("score-screen").style.display = "block";
    document.getElementById("final-score").textContent = score + " / 10";
  }

  // --- DATABASE FUNCTIONS ---

  async function submitScore() {
    const name = document.getElementById("username").value || "Anonymous";
    const newScoreRef = push(leaderboardRef); // Creates a unique ID
    await set(newScoreRef, {
      name: name,
      score: score
    });
    
    // Switch view back to leaderboard (optional)
    document.getElementById("score-screen").innerHTML = "<h3>Score Submitted!</h3>";
  }

  function loadLeaderboard() {
    // Realtime Database query: Order by score, get last 5 (highest)
    const topScoresQuery = query(leaderboardRef, orderByChild("score"), limitToLast(5));
    
    onValue(topScoresQuery, (snapshot) => {
      const list = document.getElementById("leaderboard-list");
      list.innerHTML = "";
      const data = [];
      
      snapshot.forEach((childSnapshot) => {
        data.push(childSnapshot.val());
      });

      // Reverse because limitToLast gives ascending order
      data.reverse().forEach(entry => {
        const li = document.createElement("li");
        li.textContent = `${entry.name} - ${entry.score}/10`;
        list.appendChild(li);
      });
    });
  }

  window.onload = () => {
    showQuestion();
    loadLeaderboard();
    document.getElementById("submit-btn").onclick = submitScore;
  };
</script>



</body>
</html>
